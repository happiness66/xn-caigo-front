define("js/app/util/ajax",["js/lib/jquery-2.1.4"],function(e){function t(){return"/api"}function o(){sessionStorage.removeItem("user"),sessionStorage.removeItem("tk")}var n={};return{get1:function(t,r,a,s){("boolean"==typeof r||"undefined"==typeof r)&&(a=r,r={});var i="_="+(new Date).valueOf(),c=-1===t.indexOf("?")?"?":"&";if(t&&!/_=.*/.test(t))var u=t+c+i;var f=t+JSON.stringify(r);return a&&delete n[f],n[f]||(n[f]=e.ajax({async:!s,type:"get",url:u,data:r}),n[f].then(function(e){"4"==e.errorCode&&(o(),sessionStorage.setItem("l-return",location.pathname+location.search),location.href="../user/redirect.html")},function(e){var t=dialog({content:e.msg||e.errorInfo||"网络出错",quickClose:!0});t.show(),setTimeout(function(){t.close().remove()},2e3)})),n[f]},get:function(e,t,o){return("undefined"==typeof t||"boolean"==typeof t)&&(o=t,t={}),this.post(e,{json:t,cache:o===!1?!1:!0,close:!0},!0)},getIp:function(o){return e.ajax({type:"get",url:t()+"/ip",param:o})},post:function(r,a){var s=a.json,i=sessionStorage.getItem("token")||"";i&&(s.token=i),s.systemCode=SYSTEM_CODE,s.companyCode=SYSTEM_CODE;var c=t(r)+"/api",u={code:r,json:s},f=c+JSON.stringify(u);return a.cache||delete n[f],n[f]||(u.json=JSON.stringify(s),n[f]=e.ajax({type:"post",url:c,data:u})),n[f].then(function(e){"4"==e.errorCode&&(o(),sessionStorage.setItem("l-return",location.pathname+location.search),location.href="../user/redirect.html");var t={};return"0"==e.errorCode?(t.success=!0,t.data=e.data):(t.success=!1,t.msg=e.errorInfo),t},function(e,t,o){return console.log(o),o})}}});