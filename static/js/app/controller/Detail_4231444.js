define("js/app/controller/Detail",["js/app/controller/base","js/app/util/ajax","js/lib/swiper-3.3.1.jquery.min"],function(t,o,e){function n(){g?(c(),a()):($("#cont").remove(),t.showMsg("未传入商家编号!"))}function a(){$("#dzIcon").on("click",function(){if(!t.isLogin())return void t.goLogin();var o=$("#goodImg");o.attr("src"),-1!=o.attr("src").indexOf("/good.png")?i():i(!0)}),$("#sbtn").on("click",function(){return t.isLogin()?void $("#choseDialog").removeClass("hidden"):void(location.href="../user/login.html?return="+encodeURIComponent(location.pathname+location.search))}),$("#choseDialog").click(function(){$("#choseDialog").addClass("hidden")}),$("#caigoPay").click(function(t){t.stopPropagation(),location.href="./integral_consume.html?c="+g+"&n="+$("#name").text()}),$("#cnyPay").click(function(t){t.stopPropagation(),location.href="../pay/cny_consume.html?c="+g+"&rate="+r+"&n="+$("#name").text()}),$("#rmbPay").click(function(t){t.stopPropagation(),location.href="../pay/rmb_consume.html?c="+g+"&rate="+rate1+"&rate4="+l+"&n="+$("#name").text()})}function i(e){var n=$("#totalDzNum"),a=$("#goodImg");$("#loaddingIcon").removeClass("hidden"),o.post("808240",{json:{storeCode:g,type:1,userId:t.getUserId()}}).then(function(o){$("#loaddingIcon").addClass("hidden"),o.success?e?(n.text(+n.text()-1),a.attr("src","/static/images/good.png")):(n.text(+n.text()+1),a.attr("src","/static/images/good1.png")):o.timeout?location.href="../user/login.html?return="+encodeURIComponent(location.pathname+location.search):t.showMsg(o.msg)})}function c(){o.get(d,p).then(function(o){if($("#cont").remove(),o.success){var n=o.data;n.isDZ&&$("#goodImg").attr("src","/static/images/good1.png");var a=t.getPicArr(n.pic),i="";if(a.forEach(function(t){i+="<div class='swiper-slide'><div style='background-image:url("+t+");'></div></div>"}),$("#top-swiper").html(i),$("#name").text(n.name),$("#slogan").text(n.slogan),$("#totalDzNum").text(n.totalDzNum),$("#advert").text(n.advert),$("#address").text(n.province+" "+n.city+" "+n.area+" "+n.address),$("#detailCont").append('<a class="fr clearfix" href="tel://'+n.bookMobile+'"><span class="pr6 va-m inline_block">'+n.bookMobile+'</span><img class="wp18p va-m" src="/static/images/phone.png"/></a>'),$("#description").html(n.description),a.length&&a.length>1){new e("#swiper-container",{direction:"horizontal",pagination:".swiper-pagination"})}r=n.rate2,rate1=n.rate1,l=n.rate4}else s()})}function s(){$("#description").html('<div class="bg_fff tc wp100">暂时无法获取商家信息</div>')}var r,l,d="808218",g=t.getUrlParam("c")||"",p={code:g,userId:t.getUserId()};n()});