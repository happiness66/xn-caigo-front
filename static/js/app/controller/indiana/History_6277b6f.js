define("js/app/controller/indiana/History",["js/app/controller/base","js/app/util/ajax","js/app/util/dialog","js/app/util/dict","js/lib/iscroll"],function(a,i,n){$(function(){function n(){t(),$(".indianaDetail").on("click","li",function(){var a=$(this).attr("data-code");location.href="./detail.html?code="+a+"&&d=1"})}function t(){var a={templateCode:o,companyCode:COMPANYCODE,status:"1",start:s,limit:e};i.post("615015",{json:a}).then(function(a){if(a.success){var i=a.data.list,n=+a.data.totalCount;(e>=n||i.length<e)&&(c=!0);for(var t="",d=0;d<i.length;d++){var o=i[d];if(1==o.status){var r="",u=o.totalNum-o.investNum;if("CNY"==o.toCurrency)var v=o.toAmount/1e3+"元";else if("CGB"==o.toCurrency)var v=o.toAmount/1e3+"菜狗币";else var v=o.toAmount/1e3+"抵金券";var m=o.totalNum,f=o.investNum,h=f/m*1.55;r+='<li data-code="'+o.code+'"><div class="indiana-num">第<span id="periods">'+o.periods+"</span>期</div>",r+='<div class="indiana-has"><span id="toAmount">'+v+'</span><div class="wrapDiv"><div style="width:'+h+'rem;"></div></div></div>',r+='<div class="indiana-person"><p>总需人次</p><p class="num" id="totalNum">'+o.totalNum+"</p></div>",r+='<div class="indiana-last"><p>剩余人次</p><p class="num">'+u+"</p></div>",r+='<div class="indiana-price"><p>单价</p><p class="num" id="fromAmount">'+o.fromAmount/1e3+"</p></div></li>",t+=r,l()}}$(".indianaDetail").append(t),$(".indianaDetail li:nth-child(3n+1)").addClass("bg_1"),$(".indianaDetail li:nth-child(3n+2)").addClass("bg_2"),$(".indianaDetail li:nth-child(3n)").addClass("bg_3"),s++}p=!0})}function d(){$(".indianaDetail").append('<p class="scroll-loadding"></p>')}function l(){$(".indianaDetail").find(".scroll-loadding").remove()}var o=a.getUrlParam("templateCode"),s=1,e=10,c=!1,p=!1;n(),$(window).on("scroll",function(){p&&!c&&$(document).height()-$(window).height()-10<=$(document).scrollTop()&&(p=!1,d(),t())})})});