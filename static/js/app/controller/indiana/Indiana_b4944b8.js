define("js/app/controller/indiana/Indiana",["js/app/controller/base","js/app/util/ajax","js/app/util/dialog","js/lib/iscroll"],function(n,i,a){function s(){t()}function t(){function a(){var n={companyCode:COMPANYCODE,start:c,limit:r,status:0,orderDir:"desc"};i.post("615015",{json:n}).then(function(n){if(n.success){lists=n.data.list;var i=+n.data.totalCount;(r>=i||lists.length<r)&&(p=!0);for(var a="",s=0;s<lists.length;s++){var t=lists[s],o="",d=t.totalNum-t.investNum;if("CNY"==t.toCurrency)var v=t.toAmount/1e3+"元";else if("CGB"==t.toCurrency)var v=t.toAmount/1e3+"菜狗币";else var v=t.toAmount/1e3+"抵金券";var m=t.totalNum,f=t.investNum,h=f/m*1.55,g=t.code;o+='<li data-code="'+g+'"><div class="indiana-num">第<span id="periods">'+t.periods+"</span>期</div>",o+='<div class="indiana-has"><span id="toAmount">'+v+'</span><div class="wrapDiv"><div style="width:'+h+'rem;"></div></div></div>',o+='<div class="indiana-person"><p>总需人次</p><p class="num" id="totalNum">'+t.totalNum+"</p></div>",o+='<div class="indiana-last"><p>剩余人次</p><p class="num">'+d+"</p></div>",o+='<div class="indiana-price"><p>单价</p><p class="num" id="fromAmount">'+t.fromAmount/1e3+"</p></div></li>",a+=o,l()}$(".indianaDetail").append(a),$(".indianaDetail li:nth-child(3n+1)").addClass("bg_1"),$(".indianaDetail li:nth-child(3n+2)").addClass("bg_2"),$(".indianaDetail li:nth-child(3n)").addClass("bg_3"),$("#cont").hide(),c++}else $("#cont").hide(),e("暂时无法获取一元列夺宝列表信息！");u=!0})}$(window).on("scroll",function(){u&&!p&&$(document).height()-$(window).height()-10<=$(document).scrollTop()&&(u=!1,o(),a())}),a(),$(".indianaDetail").on("click","li",function(){location.href="./detail.html?code="+$(this).attr("data-code")});var s={companyCode:COMPANYCODE,start:"1",limit:"0",status:"123"};$.when(i.post("615025",{json:s}),n.getDictList("802006","currency")).then(function(n,i){function a(){u.scrollTop>=v.scrollHeight?u.scrollTop=0:u.scrollTop+=2}if(n.success&&i.success){var s=i.data;lists=n.data.list;for(var t="",o=0;o<lists.length;o++){var l=lists[o];if(0!=l.status){var c=l.user.mobile;c=c.substring(0,3)+"*****"+c.substring(8,11);var r=l.times,p="";p+='<p><span class="indianaType">参与</span><span class="mobile">'+c+'</span>参与<span class="indianaInfo">'+r+"</span>次夺宝</p>",2==l.status&&(p+='<p><span class="indianaType">中奖</span><span class="mobile">'+c+'</span>中得<span class="indianaInfo">'+l.jewel.toAmount/1e3+d(l.jewel.toCurrency,s)+"</span></p>"),t+=p}}$(".record_1").append(t);var u=$(".record")[0],v=$(".record_1")[0],m=$(".record_2")[0];if(u.scrollTop=0,lists.length>3){m.innerHTML=v.innerHTML;var f=100;setInterval(a,f)}}else e(n.msg)}),$(".record_1").on("click",function(){location.href="./recordLists.html"})}function o(){$(".indianaDetail").append('<p class="scroll-loadding"></p>')}function l(){$(".indianaDetail").find(".scroll-loadding").remove()}function e(n){var i=a({content:n,quickClose:!0});i.show(),setTimeout(function(){i.close().remove()},2e3)}function d(n,i){for(var a=0;a<i.length;a++)if(n==i[a].dkey)return i[a].dvalue}var c=1,r=15,p=!1,u=!1;s()});