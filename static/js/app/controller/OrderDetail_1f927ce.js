define("js/app/controller/OrderDetail",["js/app/controller/base","js/app/util/ajax","js/app/util/dict","js/app/util/dialog","js/lib/handlebars.runtime-v3.0.3","js/app/module/loadImg/loadImg"],function(e,t,s,a,o,n){$(function(){function i(){$("#orderCode").text(f),function(){var s={code:f};t.get("808066",s).then(function(t){if($("#cont").remove(),t.success){var s=t.data,a="",o=s.productOrderList;$("#orderDate").text(r(s.applyDatetime)),$("#orderStatus").text(p(s.status)),"1"==s.status?($("footer").removeClass("hidden"),$("#cbtn").on("click",function(){$("#od-mask, #od-tipbox").removeClass("hidden")}),$("#sbtn").on("click",function(){location.href="../operator/pay_order.html?code="+f}),c()):"3"==s.status&&($("#qrsh").removeClass("hidden"),$("#qr_btn").on("click",function(){l()})),"92"==s.status&&($("#remake").text(s.remark),$(".remake-wrap").removeClass("hidden"));if(o.length){var a="<ul>";o.forEach(function(t){a+='<ul><li class="ptb8 clearfix b_bd_b plr10" modelCode="'+t.productCode+'"><a class="show p_r min-h100p" href="../operator/buy.html?code='+t.productCode+'"><div class="order-img-wrap tc default-bg"><img class="center-img1" src="'+e.getImg(t.product.advPic)+'"/></div><div class="order-right-wrap clearfix"><div class="fl wp60"><p class="tl line-tow">'+t.product.name+'</p></div><div class="fl wp40 tr s_11">',t.price2&&(a+='<p class="item_totalP">'+e.formatMoneyD(t.price2)+'<span class="t_40pe s_09 pl4">菜狗币</span></p>'),t.price3&&(a+='<p class="item_totalP">'+e.formatMoneyD(t.price3)+'<span class="t_40pe s_09 pl4">抵金券</span></p>'),a+='<p class="t_80">×<span>'+t.quantity+"</span></p></div></div></a></li>"}),a+="</ul>",$("#od-ul").append(n.loadImg(a)),s.amount2&&$("#totalAmount").html(e.formatMoneyD(s.amount2)+"菜狗币"),s.amount3&&($("#cnySpan").removeClass("hidden"),$("#totalJFAmount").text(s.amount2?"+"+e.formatMoneyD(s.amount3)+"抵金券":e.formatMoneyD(s.amount3)+"抵金券")),$("#od-id").html(s.code),s.reAddress&&($("#addressTitle, #addressDiv").removeClass("hidden"),$("#addressDiv").html(v(s))),s.logisticsCode&&($("#logisticsTitle, #logisticsInfo").removeClass("hidden"),$("#logisticsComp").text(h[s.logisticsCompany]),$("#logisticsTime").text(e.formatDate(s.deliveryDatetime,"yyyy-MM-dd hh:mm:ss")),$("#logisticsNO").text(s.logisticsCode))}else m("暂时无法获取商品信息！")}else m("暂时无法获取订单信息！")})}()}function l(){$("#loaddingIcon").removeClass("hidden"),t.post("808057",{json:{code:f,updater:e.getUserId()}}).then(function(t){$("#loaddingIcon").addClass("hidden"),t.success?(m("确认收货成功！"),setTimeout(function(){e.getBack()},1e3)):m(t.msg)})}function r(e){var t=new Date(e);return t.getFullYear()+"-"+d(t.getMonth()+1)+"-"+d(t.getDate())+" "+d(t.getHours())+":"+d(t.getMinutes())+":"+d(t.getSeconds())}function d(e){return 10>e?"0"+e:e}function c(){$("#odOk").on("click",function(){u(),$("#od-mask, #od-tipbox").addClass("hidden")}),$("#odCel").on("click",function(){$("#od-mask, #od-tipbox").addClass("hidden")})}function p(e){return g[e]||"未知状态"}function u(){var s={json:{code:f,userId:e.getUserId()}};$("#loaddingIcon").removeClass("hidden"),t.post("808053",s).then(function(t){$("#loaddingIcon").addClass("hidden"),t.success?(m("取消订单成功！"),setTimeout(function(){e.getBack()},1e3)):m(t.msg)})}function m(e){var t=a({content:e,quickClose:!0});t.show(),setTimeout(function(){t.close().remove()},2e3)}var f=e.getUrlParam("code"),g=(s.get("receiptType"),s.get("orderStatus")),h=s.get("fastMail"),v=o.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,s,a){var o,n=t.helperMissing,i="function",l=this.escapeExpression;return'<p class="wp100"><span class="pr1em">收货人</span>：<span class="pl_5em">'+l((o=null!=(o=t.receiver||(null!=e?e.receiver:e))?o:n,typeof o===i?o.call(e,{name:"receiver",hash:{},data:a}):o))+'</span><span class="pl20">'+l((o=null!=(o=t.reMobile||(null!=e?e.reMobile:e))?o:n,typeof o===i?o.call(e,{name:"reMobile",hash:{},data:a}):o))+'</span></p>\r\n<p class="wp100 pt10 p_r">\r\n	<span class="ab">收货地址：</span>\r\n    <span class="t_73 s_10 pl5_5em inline_block">\r\n        <span>'+l((o=null!=(o=t.reAddress||(null!=e?e.reAddress:e))?o:n,typeof o===i?o.call(e,{name:"reAddress",hash:{},data:a}):o))+"</span>\r\n    </span>\r\n</p>\r\n"},useData:!0});i()})});