define("js/app/controller/OrderList",["js/app/controller/base","js/app/util/ajax","js/app/util/dict","js/app/module/loadImg/loadImg"],function(t,a,i,s){$(function(){function l(){o(),$("#status_ul>li:eq("+h+")").click()}function o(){$("#status_ul").on("click","li",function(t){f.start=1,$("#status_ul").find("li.active").removeClass("active");var a=$(this).addClass("active").attr("status");a="0"==a?"":a,f.status=a,d=!0,u=!1,m=!1,$("#ol-ul").empty(),$("#noItem").addClass("hidden"),n(),e(),t.stopPropagation()}),$(window).on("scroll",function(){$(this);m&&!u&&$(document).height()-$(window).height()-10<=$(document).scrollTop()&&(m=!1,n(),e())}),$("#ol-ul").on("click","li span.ol-tobuy",function(t){t.stopPropagation(),t.preventDefault();var a=$(this);location.href="../operator/pay_order.html?code="+a.closest("li[code]").attr("code")})}function e(){a.post("808068",{json:f}).then(function(a){if(a.success){var i=a.data,l="",o=+i.totalCount,e=i.list;(o<=f.limit||e.length<f.limit)&&(u=!0),e.length?(e.forEach(function(a){var i=a.productOrderList,s=(a.amount2,a.amount3,a.code);if(l+='<li class="clearfix b_bd_b b_bd_t bg_fff mt10" code="'+s+'"><a class="show plr10" href="./order_detail.html?code='+s+'" class="show"><div class="wp100 b_bd_b clearfix ptb10"><div class="fl">订单号：<span>'+s+"</span></div></div>",1==i.length)invoice=i[0],l+='<div class="wp100 clearfix ptb4 p_r min-h100p"><div class="order-img-wrap tc default-bg top4"><img class="center-img1" src="'+t.getImg(invoice.product.advPic)+'"></div><div class="order-right-wrap clearfix"><div class="fl wp60 pt12"><p class="tl line-tow">'+invoice.product.name+'</p></div><div class="fl wp40 tr pt12">',invoice.price2&&(l+='<p class="item_totalP">'+t.formatMoneyD(invoice.price2)+'<span class="t_40pe s_09 pl4">菜狗币</span></p>'),invoice.price3&&(l+='<p class="item_totalP">'+t.formatMoneyD(invoice.price3)+'<span class="t_40pe s_09 pl4">抵金券</span></p>'),l+='<p class="t_80">×<span>'+invoice.quantity+'</span></p><p>&nbsp;</p><p class="ol_total_p right0">总计:<span class="pl4">'+(a.amount2?t.formatMoneyD(a.amount2)+"菜狗币":""),l+=a.amount2&&a.amount3?(a.amount3?"+"+t.formatMoneyD(a.amount3)+"抵金券":"")+"</span></p></div></div>":(a.amount3?t.formatMoneyD(a.amount3)+"抵金券":"")+"</span></p></div></div>";else{l+='<div class="wp100 clearfix ptb4 p_r">';var o=i.splice(0,3);o.forEach(function(a){l+='<div class="fl wp33 tc plr2 ptb2" style="height: '+g+'"><div class="default-bg hp100 wp100 p_r over-hide"><img class="center-img1" src="'+t.getImg(a.product.advPic)+'"/></div></div>'})}l+='</div><div class="wp100 clearfix ptb6 '+(1==i.length?"mt1em":"")+'"><span class="fr inline_block bg_f64444 t_white s_10 plr8 ptb4 b_radius4 '+("1"==a.status?"ol-tobuy":"")+'">'+r(a.status)+"</span></div></a></li>"}),c(),$("#ol-ul").append(s.loadImg(l)),f.start+=1,m=!0):d?p():c()}else d?p():c();d=!1})}function n(){$("#ol-ul").append('<li class="scroll-loadding"></li>')}function c(){$("#ol-ul").find(".scroll-loadding").remove()}function p(){$("#ol-ul").empty(),$("#noItem").removeClass("hidden"),m=!1}function r(t){return v[t]||"未知状态"}var d,u,m,f={status:"",limit:15,start:1,orderDir:"desc",orderColumn:"apply_datetime",applyUser:sessionStorage.getItem("userId")},v=i.get("orderStatus"),g=($(window).width()-20)/3+"px",h=t.getUrlParam("i")||0;l()})});