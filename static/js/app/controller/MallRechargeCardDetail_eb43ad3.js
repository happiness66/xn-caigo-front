define("js/app/controller/MallRechargeCardDetail",["js/app/controller/base","js/app/util/ajax","js/app/module/loadImg/loadImg"],function(a,e,t){function s(){d(),$("#cardPrice").on("click","li",function(){var e=0,t=0,i=0;$(this).hasClass("active")?$(this).removeClass("active"):$(this).addClass("active"),$("#cardPrice li").each(function(){$(this).hasClass("active")&&(t=parseInt($(this).attr("data-price")),i+=t,e+=1e3*t*c),o=i,$("#totalAmount").text(a.formatMoneyD(e))})}),$("#sbtn").click(function(){var t=$("#cardNum").val(),i=$("#cardName").val(),s=$("#totalAmount").text();if("手机号"==$(".cardNum").html()){var d=/^1[3|4|5|7|8]\d{9}$/;if(!t)return void a.showMsg("请输入手机号");if(!d.test(t))return void a.showMsg("请输入正确的手机号")}if(t)if(i)if(0==s)a.showMsg("请选择充值面额");else{$("#loaddingIcon").removeClass("hidden");var n={vproductCode:r,reCardno:t,reName:i,reMobile:"0",amount:1e3*o,applyUser:a.getUserId()};e.post("808650",{json:n}).then(function(e){e.success?($("#loaddingIcon").addClass("hidden"),location.href="recharge_cardPay.html?code="+e.data.code+"&a="+o+"&rate="+c):($("#loaddingIcon").addClass("hidden"),a.showMsg(e.msg))})}else a.showMsg("请输入姓名");else a.showMsg("请输入卡号")})}function d(){e.get("808616",{code:r}).then(function(e){if(e.success){var s=e.data,d=s.price,r=[],o="";for(r=d.split(","),i=0;i<r.length;i++)o+='<li data-price="'+r[i]+'">'+r[i]+"元</li>";"3"==s.type?($(".cardNum").html("手机号"),$("#cardNum").attr("type","tel"),$("#cardNum").attr("pattern","[0-9]*"),$("#cardNum").attr("placeholder","请输入手机号")):$(".cardNum").html("加油卡号"),c=s.rate,$("#cardPrice").html(t.loadImg(o)),$("#pic").attr("src",a.getImg(s.pic,1)),$("#name").html(s.name),$("#slogan").html(s.description+s.description+s.description+s.description+s.description),$("#loaddingIcon").addClass("hidden")}else $("#loaddingIcon").addClass("hidden"),a.showMsg(e.msg)})}var r=a.getUrlParam("code"),o=0,c=1;s()});