define("js/app/controller/base",["js/app/util/common","js/app/util/ajax","js/app/util/dialog","js/app/module/loading/loading"],function(e,n,r,o){if($.fn.disable=function(){this.addClass("disabled"),this[0].disabled=!0},$.fn.enable=function(){this.removeClass("disabled"),this[0].disabled=!1},$.fn.tap=function(e){this.addClass("btn_press"),this.on("click",function(){e(this)})},$.fn.setData=function(e){var e=e||{};for(var t in e)$("[data-name="+t+"]",this).html(e[t])},Number.prototype.toFixed){var s=Number.prototype.toFixed;Number.prototype.toFixed=function(){var e=s.apply(this,arguments);return 0==e&&0==e.indexOf("-")&&(e=e.slice(1)),e}}String.prototype.temp=function(e){return this.replace(/\$\w+\$/gi,function(t){var n=e[t.replace(/\$/g,"")];return n+""=="undefined"?"":n})},Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in t)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e},$.prototype.serializeObject=function(){var e,t,n,i,r;for(e=this.serializeArray(),t={},n=t.hasOwnProperty,i=0;i<e.length;i++)r=e[i],n.call(t,r.name)||(t[r.name]=r.value);return t};var a={staticUrl:requirejs.staticUrl,back:window.history.back,loadAllTpl:'<div class="all-bar tc bg_fff ptb4"><span class="sr-only">已加载全部</span></div>',loadingTpl:'<div class="loading-bar tc"><i class="fa fa-spinner fa-spin fa-3x fa-fw margin-bottom"></i><span class="sr-only">努力加载中...</span></div>',loadEmptyTpl:'<div class="flex flex-c flex-dv t_bd hp100"><i class="s_50 fa fa-calendar-o" aria-hidden="true"></i><span class="mt10">暂无相关数据</span></div>',loading100Tpl:'<div class="flex flex-c flex-dv hp100 loading-bar"><img src="'+requirejs.staticUrl+'/images/pull.gif"/><span class="sr-only">努力加载中...</span></div>',encodeInfo:function(e,t,n,i){t=t||0,n=n||0,e=e.trim();var r=e.slice(0,t),o=e.length,s=e.slice(o-n),a="**************************************************",l=o-t-n;return i&&(a="**** **** **** **** **** **** **** **** **** **** **** ****"),l>0?r+a.substring(0,l+(i?l/4:0))+(i?" ":"")+s:e},formatDate:function(e,t){return e?new Date(e).format(t):"--"},getUrlParam:function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(t);return null!=n?decodeURIComponent(n[2]):""},findObj:function(e,t,n,i,r){var o=0,s=e.length;for(o;s>o;o++){if(e[o][t]==n&&!i)return e[o];if(i&&e[o][t]==n&&e[o][i]==r)return e[o]}},showMsg:function(e,t){var n=r({content:e,quickClose:!0});n.show(),setTimeout(function(){n.close().remove()},t||1500)},calculateSecurityLevel:function(e){for(var t=0,n=0,i=0,r=0;r<e.length;r++){var o=e.charCodeAt(r);o>=48&&57>=o?t++:o>=65&&90>=o||o>=97&&122>=o?n++:(o>=32&&47>=o||o>=58&&64>=o||o>=94&&96>=o||o>=123&&126>=o)&&i++}return 0==t&&0==n||0==t&&0==i||0==n&&0==i?"1":0!=t&&0!=n&&0!=i?"3":"2"},getUrlParam:function(e,t){var n=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),i=(t||window.location.search).substr(1).match(n);return null!=i?decodeURIComponent(i[2]):""},fmoney:function(e,n){if("undefined"==typeof e)return"0.00";n=n>0&&20>=n?n:0,e=+(e/1e3).toFixed(n);var r="";(""+e).split(".")[0].length>=5&&(e=+(e/1e4).toFixed(n),r="万"),e=parseFloat((e+"").replace(/[^\d\.-]/g,"")).toFixed(n)+"";var o=e.split(".")[0].split("").reverse(),s=e.split(".")[1]||"";for(t="",i=0;i<o.length;i++)t+=o[i]+((i+1)%3==0&&i+1!=o.length?",":"");return t.split("").reverse().join("")+(0==n?"":"."+s)+r},getUserId:function(){return sessionStorage.getItem("userId")||""},getUser:function(){return n.get("805056",{userId:a.getUserId()})},setSessionUser:function(e){sessionStorage.setItem("user","1"),sessionStorage.setItem("userId",e.data.userId),sessionStorage.setItem("token",e.data.token)},goBackUrl:function(e,t){var n=a.getUrlParam("return");if(t){var i=sessionStorage.getItem("l-return");location.href=i||e||"../user/user_info.html"}else location.href=n?n:e||"../index.html"},isLogin:function(){return!!sessionStorage.getItem("user")},getDomain:function(){return location.origin},goLogin:function(){sessionStorage.setItem("l-return",location.pathname+location.search),location.href="../user/redirect.html"},throttle:function(e,t,n){var i=n||100;clearTimeout(e.tId),e.tId=setTimeout(function(){e.call(t)},i)},getAddress:function(){var e=localStorage.getItem("addr");if(e){var t=jQuery.Deferred();return e=$.parseJSON(e),e.citylist||(e=$.parseJSON(e)),t.resolve(e),t.promise()}return n.get1("/static/js/lib/city.min.json").then(function(e){return e.citylist?(localStorage.setItem("addr",JSON.stringify(e)),e):(localStorage.setItem("addr",JSON.stringify(e)),$.parseJSON(e))})},defaultBg:"data:image/png;base64,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",getImg:function(e,t){if(!e)return"";if(e&&(e=e.split(/\|\|/)[0]),!/^http/i.test(e)){var n=t?"":"?imageMogr2/auto-orient/thumbnail/!100x100r";e=PIC_PREFIX+e+n}return e},formatMoney:function(e,t){if(!$.isNumeric(e))return"--";var n=+e/1e3;return n=Math.ceil(n*Math.pow(10,t||2))/100,n.toFixed(t||2)},formatMoneyD:function(e,t){return e=(e/1e3).toString(),e=e.replace(/(\.\d\d)\d+/gi,"$1"),parseFloat(e).toFixed(t||2)},formatJF:function(e){if(!$.isNumeric(e))return"--";var t=+e/1e3;return Math.ceil(t)},getBankCard:function(e){return e?(16==e.length?e="**** **** **** "+e.substr(12):19==e.length&&(e="**** **** **** **** "+e.substr(16)),e):""},getBack:function(){location.href=document.referrer},getDictList:function(e,t){return n.get(e,{parentKey:t})},getDictListValue:function(e,t){for(var n=0;n<t.length;n++)if(e==t[n].dkey)return t[n].dvalue},getSysConfig:function(e,t){return n.get(e,{ckey:t})},getCartLength:function(){n.get("808045",{userId:a.getUserId(),start:"1",limit:"2"}).then(function(e){e.success?e.data.list.length&&$(".buy-cart-icon .infoIcon").removeClass("hidden"):a.showMsg(e.msg)})},getUserBrowser:function(){var e={versions:function(){{var e=navigator.userAgent;navigator.appVersion}return{trident:e.indexOf("Trident")>-1,presto:e.indexOf("Presto")>-1,webKit:e.indexOf("AppleWebKit")>-1,gecko:e.indexOf("Gecko")>-1&&-1==e.indexOf("KHTML"),mobile:!!e.match(/AppleWebKit.*Mobile.*/)||!!e.match(/AppleWebKit/),ios:!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:e.indexOf("Android")>-1||e.indexOf("Linux")>-1,iPhone:e.indexOf("iPhone")>-1||e.indexOf("Mac")>-1,iPad:e.indexOf("iPad")>-1,webApp:-1==e.indexOf("Safari")}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()};return e.versions.ios||e.versions.iPhone||e.versions.iPad?!0:e.versions.android?!1:void 0},confirm:function(e,t,n){return new Promise(function(i,o){var s=r({content:e,ok:function(){var e=this;return setTimeout(function(){e.close().remove()},1e3),i(),!0},cancel:function(){return o(),!0},cancelValue:t||"取消",okValue:n||"确定"});s.showModal()})},getPic:function(e){return e?(e=e.split(/\|\|/)[0],/^http|^data:image/i.test(e)||(e=PIC_PREFIX+e),e):""},getPicArr:function(e,t){return e?e.split(/\|\|/).map(function(e){return a.getPic(e,t)}):[]},getRealLocation:function(e,t,n,i,r,s,l){a.getAddress().then(function(c){citylist=c.citylist;$.each(citylist,function(e,r){a.isAddrEqual(r.p,t)&&(t=r.p,$.each(r.c,function(e,t){a.isAddrEqual(t.n,n)&&(n=t.n,t.a&&t.a[0].s&&i&&$.each(t.a,function(e,t){a.isAddrEqual(t.s,i)&&(i=t.s)}))}))}),o.hideLoading(),t?(sessionStorage.setItem("dw-province",t),sessionStorage.setItem("dw-city",n),sessionStorage.setItem("dw-area",i),sessionStorage.setItem("dw-longitude",r),sessionStorage.setItem("dw-latitude",s),""==i&&(i=n),sessionStorage.setItem("province",t),sessionStorage.setItem("city",n),sessionStorage.setItem("area",i),sessionStorage.setItem("longitude",r),sessionStorage.setItem("latitude",s),e(citylist)):(a.showMsg("定位失败"),l&&l())})},getInitLocation:function(e,t){var n=sessionStorage.getItem("province")||"",i=(sessionStorage.getItem("city")||"",sessionStorage.getItem("area")||"",sessionStorage.getItem("longitude",i)),r=sessionStorage.getItem("latitude",r);o.createLoading("定位中..."),n?(o.hideLoading(),e()):(map=new AMap.Map("",{resizeEnable:!0}),map.plugin("AMap.Geolocation",function(){geolocation=new AMap.Geolocation({enableHighAccuracy:!0,timeout:1e3}),map.addControl(geolocation),geolocation.getCurrentPosition(),AMap.event.addListener(geolocation,"complete",function(n){var i=n.position.getLng(),r=n.position.getLat(),s=n.addressComponent,a=s.province,l=s.city,c=s.district;a&&l&&c?(sessionStorage.setItem("province",a),sessionStorage.setItem("city",l),sessionStorage.setItem("area",c),sessionStorage.setItem("longitude",i),sessionStorage.setItem("latitude",r),o.hideLoading(),e()):(o.hideLoading(),t())}),AMap.event.addListener(geolocation,"error",function(){o.hideLoading(),t()})}))}};return/\/redirect\.html/.test(location.href)||/\/demo\.html/.test(location.href)||(sessionStorage.setItem("flagHb",a.getUrlParam("flagHb")||"0"),sessionStorage.setItem("hbCode",a.getUrlParam("hbCode")||"0"),sessionStorage.setItem("uMobile",a.getUrlParam("hbCode")||"0"),sessionStorage.setItem("returnFUrl",location.href),sessionStorage.setItem("userReferee",a.getUrlParam("userReferee")||""),a.isLogin()||a.goLogin()),a});