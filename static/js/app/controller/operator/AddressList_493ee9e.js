define("js/app/controller/operator/AddressList",["js/app/controller/base","js/app/util/ajax","js/app/util/dialog","js/lib/handlebars.runtime-v3.0.3"],function(a,e,s,n){function t(){$("#loaddingIcon").removeClass("hidden"),param1={code:u.prev().find("a").attr("code"),token:o},e.post("805161",{json:param1}).then(function(a){if($("#loaddingIcon").addClass("hidden"),a.success){var e=$("#addressDiv");if(1==e.children("div").length)i("#addressDiv",1);else{var s=u.parent();u.prev().find(".radio-tip.active").length&&(s.index()?e.children("div:first").find(".radio-tip").addClass("active"):s.next().find(".radio-tip").addClass("active")),s.remove()}d("收货地址删除成功！")}else d("收货地址删除失败！")})}function d(a){var e=s({content:a,quickClose:!0});e.show(),setTimeout(function(){e.close().remove()},2e3)}function i(a,e){var s="暂时无法获取数据";e&&(s="暂时没有收货地址",$("footer").removeClass("hidden")),$(a).replaceWith('<div class="bg_fff" style="text-align: center;line-height: 150px;">'+s+"</div>")}var r=sessionStorage.getItem("userId"),o=sessionStorage.getItem("token"),l="805165",c=a.getUrlParam("c"),p=sessionStorage.getItem("returnhref"),f=n.template({1:function(a,e,s,n){var t,d=e.helperMissing,i="function",r=this.escapeExpression;return'	<div class="p_r z_index0">\r\n		<div class="wp100 addr_div bg_fff p_r">\r\n		    <a class="ptb20 b_bd_b p_r show plr10" code="'+r((t=null!=(t=e.code||(null!=a?a.code:a))?t:d,typeof t===i?t.call(a,{name:"code",hash:{},data:n}):t))+'">\r\n		        <p class="s_11 t_bold">\r\n		            <span class="a-addressee">'+r((t=null!=(t=e.addressee||(null!=a?a.addressee:a))?t:d,typeof t===i?t.call(a,{name:"addressee",hash:{},data:n}):t))+'</span>\r\n		            <span class="a-mobile" class="pl10">'+r((t=null!=(t=e.mobile||(null!=a?a.mobile:a))?t:d,typeof t===i?t.call(a,{name:"mobile",hash:{},data:n}):t))+'</span>\r\n		        </p>\r\n		        <p class="s_10 pr22 t_323232">\r\n		            <span class="pr10 a-province">'+r((t=null!=(t=e.province||(null!=a?a.province:a))?t:d,typeof t===i?t.call(a,{name:"province",hash:{},data:n}):t))+'</span>\r\n		            <span class="pr10 a-city">'+r((t=null!=(t=e.city||(null!=a?a.city:a))?t:d,typeof t===i?t.call(a,{name:"city",hash:{},data:n}):t))+'</span>\r\n		            <span class="pr10 a-district">'+r((t=null!=(t=e.district||(null!=a?a.district:a))?t:d,typeof t===i?t.call(a,{name:"district",hash:{},data:n}):t))+'</span>\r\n		            <span class="a-detailAddress">'+r((t=null!=(t=e.detailAddress||(null!=a?a.detailAddress:a))?t:d,typeof t===i?t.call(a,{name:"detailAddress",hash:{},data:n}):t))+'</span>\r\n		        </p>\r\n		    </a>\r\n		    \r\n		    <div class="radio-tip"><i></i></div>\r\n	    </div>\r\n	    <div class="s_10 al_addr_del">删除</div>\r\n    </div>\r\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(a,e,s,n){var t;return null!=(t=e.each.call(a,null!=a?a.items:a,{name:"each",hash:{},fn:this.program(1,n,0),inverse:this.noop,data:n}))?t:""},useData:!0}),v=a.getUrlParam("return"),h={userId:r,token:o,isDefault:""};e.post(l,{json:h}).then(function(e){if($("#cont").remove(),e.success){var s=e.data,n="";if(s.length){var n=f({items:s});$("#addressDiv").append(n),s.forEach(function(a,e){1==a.isDefault&&$("#addressDiv").find(".z_index0").eq(e).children("div").children(".radio-tip").addClass("active")}),$("footer").removeClass("hidden")}else i("#addressDiv",1)}else i("#addressDiv"),a.showMsg(e.msg)}),$("#addressDiv").on("click","div div .radio-tip",function(){var a=$(this).siblings("a");$("#loaddingIcon").removeClass("hidden");var s={userId:r,addressee:a.find(".a-addressee").text(),mobile:a.find(".a-mobile").text(),province:a.find(".a-province").text(),city:a.find(".a-city").text(),district:a.find(".a-district").text(),detailAddress:a.find(".a-detailAddress").text(),isDefault:"1",code:a.attr("code")};e.post("805163",{json:s}).then(function(a){a.success?($("#loaddingIcon").addClass("hidden"),v?location.href=p:location.reload(!0)):$("#loaddingIcon").addClass("hidden")})}),$("#addressDiv").on("click","a",function(){var a=$(this).attr("code");location.href=c?"./add_address.html?eCode="+a+"&return=1":"./add_address.html"}),$("#addressDiv").on("touchstart",".addr_div",function(a){a.stopPropagation();var e=a.originalEvent.targetTouches[0],s=$(this),n=s.offset().left;s.data("x",e.clientX),s.data("offsetLeft",n)}),$("#addressDiv").on("touchmove",".addr_div",function(a){a.stopPropagation();var e=a.originalEvent.changedTouches[0],s=$(this),n=e.clientX,t=parseInt(s.data("x"))-n,d=s.data("offsetLeft");if(t>10)s.css({transition:"none",transform:"translate3d("+-t/2+"px, 0px, 0px)"});else if(-10>t){var d=s.data("offsetLeft");s.css({transition:"none",transform:"translate3d("+(d+-t/2)+"px, 0px, 0px)"})}}),$("#addressDiv").on("touchend",".addr_div",function(a){a.stopPropagation();var e=$(this),s=a.originalEvent.changedTouches[0],n=s.clientX,t=parseInt(e.data("x"))-n;e.css(t>56?{transition:"-webkit-transform 0.2s ease-in",transform:"translate3d(-56px, 0px, 0px)"}:{transition:"-webkit-transform 0.2s ease-in",transform:"translate3d(0px, 0px, 0px)"})});var u;$("#addressDiv").on("click",".al_addr_del",function(a){a.stopPropagation(),u=$(this),$("#od-mask, #od-tipbox").removeClass("hidden")}),$("#sbtn").on("click",function(){location.href=c?"./add_address.html?return=1":"./add_address.html"}),$("#odOk").on("click",function(){t(),$("#od-mask, #od-tipbox").addClass("hidden")}),$("#odCel").on("click",function(){$("#od-mask, #od-tipbox").addClass("hidden")})});