define("js/app/controller/ResetPwd",["js/app/controller/base","js/app/util/ajax","js/app/util/dialog"],function(n,e,s){$(function(){function t(){$("#origPassword").on("change",c).on("focus",function(){$(this).siblings(".register_verifycon").css({display:"block"})}).on("blur",function(){$(this).siblings(".register_verifycon").css({display:"none"})}),$("#password").on("change",u).on("focus",function(){$(this).siblings(".register_verifycon").css({display:"block"})}).on("blur",function(){$(this).siblings(".register_verifycon").css({display:"none"})}),$("#repassword").on("change",d).on("focus",function(){$(this).siblings(".register_verifycon").css({display:"block"})}).on("blur",function(){$(this).siblings(".register_verifycon").css({display:"none"})}),$("#sbtn").on("click",function(){o()})}function o(){c()&&u()&&d()&&i()}function i(){$("#sbtn").attr("disabled","disabled").text("设置中...");var s=sessionStorage.getItem("userId"),t=sessionStorage.getItem("token"),o={userId:s,oldLoginPwd:$("#origPassword").val(),newLoginPwd:$("#password").val(),loginPwdStrength:n.calculateSecurityLevel($("#password").val()),token:t};e.post(805049,{json:o}).then(function(n){n.success?a():($("#sbtn").removeAttr("disabled").text("设置"),r(n.msg))})}function a(){sessionStorage.setItem("user","0"),$("#sbtn").text("设置"),r("登录密码修改成功!"),sessionStorage.setItem("user","0"),setTimeout(function(){location.href="./login.html"},1e3)}function r(n){var e=s({content:n,quickClose:!0});e.show(),setTimeout(function(){e.close().remove()},2e3)}function c(){var n,e=$("#origPassword")[0],s=e.parentNode,t=/^[^\s]{6,16}$/;return""==e.value?(n=$(s).find("span.warning")[0],$(n).fadeIn(150).fadeOut(3e3),!1):t.test(e.value)?!0:(n=$(s).find("span.warning")[1],$(n).fadeIn(150).fadeOut(3e3),!1)}function u(){var n,e=$("#password")[0],s=e.parentNode,t=/^[^\s]{6,16}$/;return""==e.value?(n=$(s).find("span.warning")[0],$(n).fadeIn(150).fadeOut(3e3),!1):t.test(e.value)?!0:(n=$(s).find("span.warning")[1],$(n).fadeIn(150).fadeOut(3e3),!1)}function d(){var n,e=$("#password")[0],s=$("#repassword")[0],t=s.parentNode;return""==s.value?(n=$(t).find("span.warning")[0],$(n).fadeIn(150).fadeOut(3e3),!1):s.value!==e.value?(n=$(t).find("span.warning")[1],$(n).fadeIn(150).fadeOut(3e3),!1):!0}t()})});